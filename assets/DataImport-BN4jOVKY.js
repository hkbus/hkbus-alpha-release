import{j as n,u as y,r as a,A as S,L as x,M as f,N as w,O as v}from"./index-B5N-jUy8.js";import{t as b}from"./index-CJ_zZ9Gs.js";import{c as A,u as R,h as j,b as C,e as M,aO as m,i as O}from"./App-BP_5kTt-.js";const F=A(n.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),L=()=>{const{data:r}=R(),{t:i}=y(),{importAppState:u,importCollectionState:p}=a.useContext(S),d=j(),[c,E]=a.useState(r??""),h=a.useMemo(()=>b(e=>{try{return JSON.parse(x.decompress(decodeURIComponent(e),{inputEncoding:"Base64"}))}catch{return{}}},500),[]),t=a.useMemo(()=>{try{let e=h(r??c.split("/").pop()??"");if(!Array.isArray(e.savedStops)||!f(e.savedStops))throw new Error("Error in parsing savedStops");if(!Array.isArray(e.savedEtas)||!f(e.savedEtas))throw new Error("Error in parsing savedEtas");if(!Array.isArray(e.collections))throw new Error("Error in parsing collections");for(let o=0;o<e.collections.length;++o){if(typeof e.collections[o].name!="string")throw new Error("Error in parsing collections");for(let s=0;s<e.collections[o].list.length;++s)if(typeof e.collections[o].list[s]!="string")throw new Error("Error in parsing collections");for(let s=0;s<e.collections[o].schedules.length;++s){if(typeof e.collections[o].schedules[s].day!="number")throw new Error("Error in parsing collections");if(typeof e.collections[o].schedules[s].start.hour!="number")throw new Error("Error in parsing collections");if(typeof e.collections[o].schedules[s].start.minute!="number")throw new Error("Error in parsing collections");if(typeof e.collections[o].schedules[s].end.hour!="number")throw new Error("Error in parsing collections");if(typeof e.collections[o].schedules[s].end.minute!="number")throw new Error("Error in parsing collections")}}return e}catch(e){console.error(e)}return{}},[h,r,c]),l=a.useMemo(()=>JSON.stringify(t,null,2),[t]),g=a.useCallback(()=>{l!=="{}"&&(p({savedStops:t.savedStops??[],savedEtas:t.savedEtas??[],collections:t.collections??[],collectionDrawerRoute:null,collectionIdx:null}),u({geoPermission:null,compassPermission:"default",geolocation:w,manualGeolocation:null,searchRoute:"",selectedRoute:"1-1-CHUK-YUEN-ESTATE-STAR-FERRY",routeSearchHistory:t.routeSearchHistory??[],isRouteFilter:t.isRouteFilter??!0,busSortOrder:t.busSortOrder??"KMB first",numPadOrder:t.numPadOrder??"123456789c0b",etaFormat:t.etaFormat??"diff",_colorMode:t._colorMode??"system",energyMode:t.energyMode??!1,platformMode:t.platformMode??!1,vibrateDuration:t.vibrateDuration??1,isVisible:!0,analytics:t.analytics??!0,refreshInterval:t.refreshInterval??30,annotateScheduled:t.annotateScheduled??!0,isRecentSearchShown:t.isRecentSearchShown??!0,fontSize:t.fontSize??16,searchRange:t.searchRange??v}),d("/"))},[t,l,u,p,d]);return n.jsxs(C,{sx:I,children:[n.jsx(M,{variant:"h6",sx:{textAlign:"center"},children:i("資料匯入")}),!r&&n.jsx(m,{variant:"outlined",value:c,onChange:({target:{value:e}})=>E(e),fullWidth:!0,label:i("匯出網址")}),n.jsx(m,{multiline:!0,maxRows:15,value:l,disabled:!0,fullWidth:!0,spellCheck:!1}),n.jsx(O,{startIcon:n.jsx(F,{}),variant:"outlined",disabled:l==="{}",onClick:g,sx:T,children:i("Accept")})]})},I={display:"flex",flexDirection:"column",justifyContent:"flex-start",flex:1,gap:1},T={color:r=>r.palette.mode==="light"?r.palette.text.primary:r.palette.primary.main,borderColor:r=>r.palette.mode==="light"?r.palette.text.primary:r.palette.primary.main};export{L as default};
